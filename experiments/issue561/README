Description of tags for this issue:

- issue561-base: base version before any changes
- issue561-v1: mostly cleanup; introduce smart pointers in some places
- issue561-v2: split off class for heuristic representation
- issue561-v3: split off class for distance computations
